<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Send comments to: Tony T (adthral)">
<meta name="author" content="Send comments to: Tony T (tthrall)">

<title>13&nbsp; Time Series Spectrum Analysis – EDA for Machine Learning</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./graph-theory.html" rel="next">
<link href="./ts-forecast.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-364982630eef5352dd1537128a8ed5cb.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ts-intro.html">Time Series Data</a></li><li class="breadcrumb-item"><a href="./ts-fourier.html"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Time Series Spectrum Analysis</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">EDA for Machine Learning</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/tthrall/eda4ml/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Statistics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conditioning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Conditional Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./clustering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Clustering: EDA in Higher Dimensions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./simulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Statistical Simulation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./study-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Sampling and Study Design</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Linear Algebra</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./la-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Some Linear Algebra</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reduce-dim.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Dimension Reduction</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Text Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./text-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Text Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dirichlet-dstn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">The Dirichlet Distribution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./latent-dirichlet-alloc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Latent Dirichlet Allocation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Time Series Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ts-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Time Series Data Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ts-forecast.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Time Series Forecasting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ts-fourier.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Time Series Spectrum Analysis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Graph Theory</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./graph-theory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Graph Theory for Machine Learning</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./em-algorithm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">EM: the Expectation-Maximization Algorithm</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-intro" id="toc-sec-intro" class="nav-link active" data-scroll-target="#sec-intro"><span class="header-section-number">13.1</span> Introduction</a>
  <ul class="collapse">
  <li><a href="#sunspots" id="toc-sunspots" class="nav-link" data-scroll-target="#sunspots"><span class="header-section-number">13.1.1</span> Sunspots</a></li>
  <li><a href="#average-daily-temperatures" id="toc-average-daily-temperatures" class="nav-link" data-scroll-target="#average-daily-temperatures"><span class="header-section-number">13.1.2</span> Average daily temperatures</a></li>
  </ul></li>
  <li><a href="#sec-math-fmwk" id="toc-sec-math-fmwk" class="nav-link" data-scroll-target="#sec-math-fmwk"><span class="header-section-number">13.2</span> Mathematical Framework</a>
  <ul class="collapse">
  <li><a href="#data-derived-from-a-random-process" id="toc-data-derived-from-a-random-process" class="nav-link" data-scroll-target="#data-derived-from-a-random-process"><span class="header-section-number">13.2.1</span> Data derived from a random process</a></li>
  <li><a href="#stationarity" id="toc-stationarity" class="nav-link" data-scroll-target="#stationarity"><span class="header-section-number">13.2.2</span> Stationarity</a></li>
  <li><a href="#auto-covariance-function" id="toc-auto-covariance-function" class="nav-link" data-scroll-target="#auto-covariance-function"><span class="header-section-number">13.2.3</span> Auto-covariance function</a></li>
  <li><a href="#spectrum" id="toc-spectrum" class="nav-link" data-scroll-target="#spectrum"><span class="header-section-number">13.2.4</span> Spectrum</a></li>
  <li><a href="#spectrum-density-functions" id="toc-spectrum-density-functions" class="nav-link" data-scroll-target="#spectrum-density-functions"><span class="header-section-number">13.2.5</span> Spectrum density functions</a></li>
  <li><a href="#cramér-representation" id="toc-cramér-representation" class="nav-link" data-scroll-target="#cramér-representation"><span class="header-section-number">13.2.6</span> Cramér representation</a></li>
  <li><a href="#filtering" id="toc-filtering" class="nav-link" data-scroll-target="#filtering"><span class="header-section-number">13.2.7</span> Filtering</a></li>
  <li><a href="#white-noise" id="toc-white-noise" class="nav-link" data-scroll-target="#white-noise"><span class="header-section-number">13.2.8</span> White noise</a></li>
  <li><a href="#white-noise-filtered" id="toc-white-noise-filtered" class="nav-link" data-scroll-target="#white-noise-filtered"><span class="header-section-number">13.2.9</span> White noise filtered</a></li>
  <li><a href="#arma-models" id="toc-arma-models" class="nav-link" data-scroll-target="#arma-models"><span class="header-section-number">13.2.10</span> ARMA models</a></li>
  <li><a href="#ar1" id="toc-ar1" class="nav-link" data-scroll-target="#ar1"><span class="header-section-number">13.2.11</span> AR(1)</a></li>
  <li><a href="#ma1" id="toc-ma1" class="nav-link" data-scroll-target="#ma1"><span class="header-section-number">13.2.12</span> MA(1)</a></li>
  <li><a href="#arma1-1" id="toc-arma1-1" class="nav-link" data-scroll-target="#arma1-1"><span class="header-section-number">13.2.13</span> ARMA(1, 1)</a></li>
  <li><a href="#comparison-of-arma-models" id="toc-comparison-of-arma-models" class="nav-link" data-scroll-target="#comparison-of-arma-models"><span class="header-section-number">13.2.14</span> Comparison of ARMA models</a></li>
  </ul></li>
  <li><a href="#sec-finite-FT" id="toc-sec-finite-FT" class="nav-link" data-scroll-target="#sec-finite-FT"><span class="header-section-number">13.3</span> Finite Fourier transform</a>
  <ul class="collapse">
  <li><a href="#definition" id="toc-definition" class="nav-link" data-scroll-target="#definition"><span class="header-section-number">13.3.1</span> Definition</a></li>
  <li><a href="#cramér-representation-1" id="toc-cramér-representation-1" class="nav-link" data-scroll-target="#cramér-representation-1"><span class="header-section-number">13.3.2</span> Cramér representation</a></li>
  <li><a href="#data-windows-and-their-frequency-kernels" id="toc-data-windows-and-their-frequency-kernels" class="nav-link" data-scroll-target="#data-windows-and-their-frequency-kernels"><span class="header-section-number">13.3.3</span> Data windows and their frequency kernels</a></li>
  <li><a href="#asymptotic-normality" id="toc-asymptotic-normality" class="nav-link" data-scroll-target="#asymptotic-normality"><span class="header-section-number">13.3.4</span> Asymptotic normality</a></li>
  </ul></li>
  <li><a href="#sec-spec-est" id="toc-sec-spec-est" class="nav-link" data-scroll-target="#sec-spec-est"><span class="header-section-number">13.4</span> Spectrum Estimation</a>
  <ul class="collapse">
  <li><a href="#periodogram" id="toc-periodogram" class="nav-link" data-scroll-target="#periodogram"><span class="header-section-number">13.4.1</span> Periodogram</a></li>
  <li><a href="#dft-discrete-fourier-transform" id="toc-dft-discrete-fourier-transform" class="nav-link" data-scroll-target="#dft-discrete-fourier-transform"><span class="header-section-number">13.4.2</span> DFT: Discrete Fourier transform</a></li>
  <li><a href="#smoothed-periodogram" id="toc-smoothed-periodogram" class="nav-link" data-scroll-target="#smoothed-periodogram"><span class="header-section-number">13.4.3</span> Smoothed periodogram</a></li>
  </ul></li>
  <li><a href="#sec-spec-examples" id="toc-sec-spec-examples" class="nav-link" data-scroll-target="#sec-spec-examples"><span class="header-section-number">13.5</span> Examples of Spectrum Analysis</a>
  <ul class="collapse">
  <li><a href="#sunspots-1" id="toc-sunspots-1" class="nav-link" data-scroll-target="#sunspots-1"><span class="header-section-number">13.5.1</span> Sunspots</a></li>
  <li><a href="#city-temperatures" id="toc-city-temperatures" class="nav-link" data-scroll-target="#city-temperatures"><span class="header-section-number">13.5.2</span> City Temperatures</a></li>
  </ul></li>
  <li><a href="#closing-remarks" id="toc-closing-remarks" class="nav-link" data-scroll-target="#closing-remarks"><span class="header-section-number">13.6</span> Closing Remarks</a></li>
  <li><a href="#sec-glossary" id="toc-sec-glossary" class="nav-link" data-scroll-target="#sec-glossary"><span class="header-section-number">13.7</span> A: Glossary of Notation</a></li>
  <li><a href="#sec-data-examples" id="toc-sec-data-examples" class="nav-link" data-scroll-target="#sec-data-examples"><span class="header-section-number">13.8</span> B: Data Examples</a>
  <ul class="collapse">
  <li><a href="#sunspot-numbers-monthly-averages-1749---present" id="toc-sunspot-numbers-monthly-averages-1749---present" class="nav-link" data-scroll-target="#sunspot-numbers-monthly-averages-1749---present"><span class="header-section-number">13.8.1</span> Sunspot Numbers: Monthly Averages, 1749 - Present</a></li>
  <li><a href="#daily-city-temperatures-1995-2020" id="toc-daily-city-temperatures-1995-2020" class="nav-link" data-scroll-target="#daily-city-temperatures-1995-2020"><span class="header-section-number">13.8.2</span> Daily City Temperatures: 1995-2020</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">13.9</span> References</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/tthrall/eda4ml/edit/main/ts-fourier.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/tthrall/eda4ml/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ts-intro.html">Time Series Data</a></li><li class="breadcrumb-item"><a href="./ts-fourier.html"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Time Series Spectrum Analysis</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-ts-fourier" class="quarto-section-identifier"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Time Series Spectrum Analysis</span></span></h1>
<p class="subtitle lead">An Introduction</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Send comments to: Tony T (adthral) </p>
             <p>Send comments to: Tony T (tthrall) </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">21:05 Tue 14-Oct-2025</p>
    </div>
  </div>
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="block-title">Abstract</div>
    Introduce the Fourier spectrum of a time series. <br><br>
  </div>
</div>


</header>


<section id="sec-intro" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="sec-intro"><span class="header-section-number">13.1</span> Introduction</h2>
<p>The analysis of time series has proved to have both pragmatic and scientific value. For time series that track business activity or broader economic activity, the ability to forecast future values with some degree of reliability has evident practical value. The potential of such forecasting has influenced the development of time domain models, notably auto-regressive moving average (ARMA) models.</p>
<p>On the other hand, natural processes often exhibit periodic behavior, and have given rise to the Fourier decomposition of such time series, that is, the representation of the process as a sum of sine waves over a range of frequencies.</p>
<section id="sunspots" class="level3" data-number="13.1.1">
<h3 data-number="13.1.1" class="anchored" data-anchor-id="sunspots"><span class="header-section-number">13.1.1</span> Sunspots</h3>
<p>An early example of such periodic behavior is shown in <a href="#fig-sunspots" class="quarto-xref">Figure&nbsp;<span>13.8</span></a>, the time series of monthly sunspot numbers. Sunspots have been observed for millennia, but systematic scientific observations began in the 1600’s.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>Sunspots are a key indicator of the solar magnetic activity cycle in which the sun’s magnetic polarity reverses every 11 years or so. At the peak of a cycle the sun emits bursts of charged particles (solar flares) across the solar system that affect the Earth. Consequently, understanding the solar cycle has both scientific and practical value.</p>
<p>Gaps between peak sunspot numbers vary, so a simple sinusoidal wave (or other function) having a fixed period does not fit the data well. On the other hand, the variability of the data is clarified by Fourier decomposition and subsequent grouping of fitted sine waves within successive bands of frequencies. This approach is discussed in <a href="#sec-math-fmwk" class="quarto-xref"><span>Section 13.2</span></a>.</p>
</section>
<section id="average-daily-temperatures" class="level3" data-number="13.1.2">
<h3 data-number="13.1.2" class="anchored" data-anchor-id="average-daily-temperatures"><span class="header-section-number">13.1.2</span> Average daily temperatures</h3>
<p><a href="#fig-hnl-nyc-temps" class="quarto-xref">Figure&nbsp;<span>13.9</span></a> shows average daily temperatures for Honolulu and New York City over a 25-year period (1995-2020). The overall average temperature in NYC is about 56 (F), well below that of Honolulu (77). Also note that the standard deviation of NYC temperatures,17.1 (F), is well above that of Honolulu (3.4). So Honolulu temperatures are higher than those of NYC and fluctuate less (as visitors to those two cities may testify). Less clear, however, is the degree to which seasonal variation accounts for the overall variation in each city. This is a question that can be addressed by Fourier decomposition.</p>
</section>
</section>
<section id="sec-math-fmwk" class="level2" data-number="13.2">
<h2 data-number="13.2" class="anchored" data-anchor-id="sec-math-fmwk"><span class="header-section-number">13.2</span> Mathematical Framework</h2>
<section id="data-derived-from-a-random-process" class="level3" data-number="13.2.1">
<h3 data-number="13.2.1" class="anchored" data-anchor-id="data-derived-from-a-random-process"><span class="header-section-number">13.2.1</span> Data derived from a random process</h3>
<p>Statistical data usually take the form of one or more data frames in which each row represents an observation and each column represents a variable of interest. For example, here are the first few values of the temperature data shown in <a href="#fig-hnl-nyc-temps" class="quarto-xref">Figure&nbsp;<span>13.9</span></a>.</p>
<div id="tbl-HNL-NYC-wide" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-HNL-NYC-wide-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;13.1: Temperatures (F) from Honolulu and New York City, 1995-2020
</figcaption>
<div aria-describedby="tbl-HNL-NYC-wide-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9,265 × 3
  date         HNL   NYC
  &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt;
1 1995-01-01  71.3  44  
2 1995-01-02  72.5  41.8
3 1995-01-03  73.2  28.1
# ℹ 9,262 more rows</code></pre>
</div>
</div>
</figure>
</div>
<p>The distinction of time series analysis is that observations are indexed by time<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>, and are not assumed to be statistically independent. Instead, time series data are typically modeled as a realization of a random process of the following form.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<p><span id="eq-X-bullet"><span class="math display">\[
\begin{align}
  X_\bullet (t) = (X_1 (t), \ldots, X_d (t)) \in \mathbb{R}^d
\end{align}
\qquad(13.1)\]</span></span></p>
<p>If the number of data columns is two or greater <span class="math inline">\((d \ge 2)\)</span>, the process is said to be multivariate. Otherwise, if <span class="math inline">\(d = 1\)</span> the process is said to be univariate, and the notation is simplified to <span class="math inline">\(X (t)\)</span>.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<p>In our example there are two data columns (<code>HNL</code>, <code>NYC</code>), so that <span class="math inline">\(d = 2\)</span>, the unit of time is one day, and the sampling frequency is once per day.</p>
<p>The random process is idealized to span all time <span class="math inline">\((t \in \mathbb{Z})\)</span>, but the data of course span some finite period, <span class="math inline">\(\tau_T\)</span>, of length <span class="math inline">\(T\)</span>.</p>
<p><span id="eq-tau-T"><span class="math display">\[
\begin{align}
  \tau_T &amp;=  \{ t_0, \; t_0 + 1, \ldots, t_f \} \\
  t_0 &amp;=  \text{ initial data index} = \min \tau_T \\
  t_f &amp;=  \text{ final data index} = \max \tau_T \\
  T &amp;=  \text{ number of observatons } = t_f - t_0 + 1 \\
  \nu_T &amp;= \tau_T - t_0 =  \{ 0, 1, \ldots, T-1 \}
\end{align}
\qquad(13.2)\]</span></span></p>
<p>The expected value of the random process may be modeled by various functions of time: a constant, a linear trend, a seasonal component (periodic function), etc.</p>
<p><span id="eq-m-bullet"><span class="math display">\[
\begin{align}
  m_\bullet (t) &amp;= E \{ X_\bullet (t) \}
\end{align}
\qquad(13.3)\]</span></span></p>
</section>
<section id="stationarity" class="level3" data-number="13.2.2">
<h3 data-number="13.2.2" class="anchored" data-anchor-id="stationarity"><span class="header-section-number">13.2.2</span> Stationarity</h3>
<p>In an additive model (which is most common), the centered random process, <span class="math inline">\(X_\bullet (t) - m_\bullet (t)\)</span> , is assumed to be <strong>second-order stationary</strong>.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> That is, if we shift <span class="math inline">\(X_\bullet (\cdot)\)</span> by any number of time units <span class="math inline">\(s\)</span> to obtain a new process <span class="math inline">\(Y_\bullet (\cdot)\)</span>, we assume that the respective covariance structures of <span class="math inline">\(X_\bullet (\cdot)\)</span> and <span class="math inline">\(Y_\bullet (\cdot)\)</span> are the same.</p>
<p><span id="eq-back-shift-s"><span class="math display">\[
\begin{align}
  Y_\bullet (t) &amp;= \mathcal{B}^s \{ X_\bullet (\cdot) \} (t)  \\
  &amp;= X_\bullet (t - s)
\end{align}
\qquad(13.4)\]</span></span></p>
<p>Here <span class="math inline">\(\mathcal{B}\)</span> denotes the <em>back-shift</em> operator that shifts time by one unit, so that <span class="math inline">\(\mathcal{B}^s\)</span> (that is, <span class="math inline">\(s\)</span> repeated applications of <span class="math inline">\(\mathcal{B}\)</span>) shifts time by <span class="math inline">\(s\)</span> units. Then second-order stationarity can be expressed as follows.</p>
<p><span class="math display">\[
\begin{align}
  Cov \{ X_a (t + u), X_b (t) \}
  &amp;= Cov \{ Y_a (t + u), Y_b (t) \} \\
  &amp;= Cov \{ X_a (t + u - s), X_b (t - s) \} \\
  \\
  &amp; \text{for all } s \in \mathbb{Z} \text{ and } a, b \in \{ 1, \ldots, d \}
\end{align}
\]</span></p>
</section>
<section id="auto-covariance-function" class="level3" data-number="13.2.3">
<h3 data-number="13.2.3" class="anchored" data-anchor-id="auto-covariance-function"><span class="header-section-number">13.2.3</span> Auto-covariance function</h3>
<p>Setting <span class="math inline">\(s = t\)</span> in the last expression we have</p>
<p><span id="eq-stationarity-2"><span class="math display">\[
\begin{align}
  Cov \{ X_a (t + u), X_b (t) \}
  &amp;= Cov \{ X_a (u), X_b (0) \}
\end{align}
\qquad(13.5)\]</span></span></p>
<p>Consequently, second-order stationarity enables one to define and estimate the following <em>auto-covariance</em> function.</p>
<p><span id="eq-ACovF"><span class="math display">\[
\begin{align}
  \gamma_{\bullet, \bullet} (u) &amp;= \left \{ \gamma_{a, b} (u) \right \}_{a, b = 1}^d \\ \\
  \text{where} \\ \\
  \gamma_{a, b} (u) &amp;= Cov \{ X_a (t + u), X_b (t) \} \\
  &amp;= Cov \{ X_a (u), X_b (0) \}
\end{align}
\qquad(13.6)\]</span></span></p>
<p>Although <span class="math inline">\(\gamma_{\bullet, \bullet} (u)\)</span> is a symmetric matrix at <span class="math inline">\(u = 0\)</span>, it is not generally symmetric at <span class="math inline">\(u \ne 0\)</span>. The symmetry relation we do have is that matrix <span class="math inline">\(\gamma_{\bullet, \bullet} (-u)\)</span> is the transpose of matrix <span class="math inline">\(\gamma_{\bullet, \bullet} (u)\)</span>.</p>
<p><span id="eq-ACovF-symm"><span class="math display">\[
\begin{align}
  \gamma_{a, b} (-u) &amp;= Cov \{ X_a (t - u), X_b (t) \} \\
  &amp;= Cov \{ X_a (t), X_b (t + u) \}  \\
  &amp;= Cov \{ X_b (t + u), X_a (t) \}   \\
  &amp;= \gamma_{b, a} (u)
\end{align}
\qquad(13.7)\]</span></span></p>
<p>In particular, <span class="math inline">\(\gamma_{a, a} (\cdot)\)</span> is an even function: <span class="math inline">\(\gamma_{a, a} (-u) = \gamma_{a, a} (u)\)</span>.</p>
<p>Consequently, the time-reversed process <span class="math inline">\(Y_\bullet (t) = X_\bullet (-t)\)</span> has the same auto-covariance structure as the original process, allowing for this matrix transposition.</p>
<p>The <em>autocorrelation (ACF)</em> function <span class="math inline">\(\rho_{\bullet, \bullet}(\cdot)\)</span> is the following scaled version of the auto-covariance function.</p>
<p><span id="eq-ACF"><span class="math display">\[
\begin{align}
\rho_{\bullet, \bullet} (u) &amp;= \left \{ \rho_{a, b} (u) \right \}_{a, b = 1}^d \\ \\
  \text{where} \\ \\
  \rho_{a, b} (u) &amp;= corr \{ X_a (u), X_b (0) \} \\
  &amp;= \frac{\gamma_{a, b} (u)}{\sqrt{\gamma_{a, a} (0) \; \gamma_{b, b} (0)}}
\end{align}
\qquad(13.8)\]</span></span></p>
</section>
<section id="spectrum" class="level3" data-number="13.2.4">
<h3 data-number="13.2.4" class="anchored" data-anchor-id="spectrum"><span class="header-section-number">13.2.4</span> Spectrum</h3>
<p>The term “spectrum” in its modern sense was introduced by Sir Isaac Newton<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> <a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a>, who used a prism to decompose sunlight into a rainbow of colors (light of different wavelengths or frequencies). The term came to mean the intensity<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a> (denoted “I”) of light (or other wave phenomena) as a function of wavelength or frequency.</p>
<p>Sine waves, more precisely complex-valued functions of the form</p>
<p><span id="eq-complex-sine-wave"><span class="math display">\[
\begin{align}
  f(t) = \rho e^{i \lambda t + \phi}
\end{align}
\qquad(13.9)\]</span></span></p>
<p>are widely used as the basis of this frequency decomposition, for a function of this form is an eigen-function of the back-shift operator <span class="math inline">\(\mathcal{B}\)</span>.</p>
<p><span id="eq-bs-eigen"><span class="math display">\[
\begin{align}
  \{ \; \mathcal{B}^s f(\cdot) \; \} \; (t) &amp;= f(t-s) \\
  &amp;= \rho e^{i \lambda (t - s) + \phi} \\
  &amp;= e^{- i \lambda s} \; \rho e^{i \lambda t + \phi} \\
  &amp;= e^{- i \lambda s} \; f (t)
\end{align}
\qquad(13.10)\]</span></span></p>
</section>
<section id="spectrum-density-functions" class="level3" data-number="13.2.5">
<h3 data-number="13.2.5" class="anchored" data-anchor-id="spectrum-density-functions"><span class="header-section-number">13.2.5</span> Spectrum density functions</h3>
<p>The <em>spectrum density function</em>, <span class="math inline">\(f_{\bullet, \bullet} (\lambda)\)</span>, of the random process <span class="math inline">\(X_\bullet(\cdot)\)</span> is defined as the Fourier transform of the auto-covariance function <span class="math inline">\(\gamma_{\bullet, \bullet} (u)\)</span>.</p>
<p><span id="eq-spec-dens"><span class="math display">\[
\begin{align}
  f_{\bullet, \bullet} (\lambda) &amp;= \sum_{u = -\infty}^\infty \gamma_{\bullet, \bullet} (u) \times e^{- i \lambda u}
\end{align}
\qquad(13.11)\]</span></span></p>
<p>where we assume that the elements of <span class="math inline">\(\gamma_{\bullet, \bullet} (\cdot)\)</span> are absolutely summable.</p>
<p><span id="eq-ACovF-sum"><span class="math display">\[
\begin{align}
  \sum_{u = -\infty}^\infty \left | \; \gamma_{a, b} (u) \; \right | &amp;&lt; \infty \\
  &amp;\text{for } a, b \in \{1, \ldots, d \}
\end{align}
\qquad(13.12)\]</span></span></p>
<p><a href="#eq-ACovF-sum" class="quarto-xref">Equation&nbsp;<span>13.12</span></a> is an example of a “mixing” condition. It implies that <span class="math inline">\(X_\bullet(t)\)</span> and <span class="math inline">\(X_\bullet(t + u)\)</span> have vanishingly small correlation as <span class="math inline">\(|u| \rightarrow \infty\)</span>.</p>
<p>Setting <span class="math inline">\(b = a\)</span>, we obtain <span class="math inline">\(f_{a, a} (\cdot)\)</span>, called the <em>power spectrum</em> of <span class="math inline">\(X_a (\cdot)\)</span>.</p>
<p>If <span class="math inline">\(b \ne a\)</span> then <span class="math inline">\(f_{a, b} (\cdot)\)</span> is called the <em>cross-spectrum</em> of <span class="math inline">\(\{ X_a (\cdot), X_b (\cdot) \}\)</span>. The <em>coherency</em> of <span class="math inline">\(X_a(\cdot), X_b(\cdot)\)</span> at frequency <span class="math inline">\(\lambda\)</span>, denoted <span class="math inline">\(R_{a, b} (\lambda)\)</span>, is the following normalization of the cross-spectrum.</p>
<p><span id="eq-coherency"><span class="math display">\[
\begin{align}
  R_{a, b} (\lambda) &amp;= \frac{f_{a, b}(\lambda)}{\sqrt{f_{a, a}(\lambda) f_{b, b}(\lambda)}}
\end{align}
\qquad(13.13)\]</span></span></p>
<p>The modulus-squared of coherency, <span class="math inline">\(| R_{a, b} (\lambda) |^2\)</span>, is called the <em>coherence</em> of <span class="math inline">\(\{ X_a (\cdot), X_b (\cdot) \}\)</span> at frequency <span class="math inline">\(\lambda\)</span>. Similar to a squared correlation coefficient, this is a non-negative value no greater than unity. And the radian angle, <span class="math inline">\(Arg( R_{a, b} (\lambda) )\)</span>, is called the <em>phase</em> of <span class="math inline">\(\{ X_a (\cdot), X_b (\cdot) \}\)</span> at frequency <span class="math inline">\(\lambda\)</span>.</p>
<p>From <a href="#eq-spec-dens" class="quarto-xref">Equation&nbsp;<span>13.11</span></a> we see that <span class="math inline">\(f_{\bullet, \bullet} (\lambda)\)</span> is periodic with period <span class="math inline">\(2 \pi\)</span>.</p>
<p><span id="eq-spec-periodic"><span class="math display">\[
\begin{align}
  f_{\bullet, \bullet} (\lambda + 2 \pi) &amp;= f_{\bullet, \bullet} (\lambda)
\end{align}
\qquad(13.14)\]</span></span></p>
<p>Due to the symmetries of the auto-covariance function (<a href="#eq-ACovF-symm" class="quarto-xref">Equation&nbsp;<span>13.7</span></a>), the spectrum density matrix is Hermitian, that is, equal to its own conjugate transpose.</p>
<p><span id="eq-spec-hermitian"><span class="math display">\[
\begin{align}
  f_{\bullet, \bullet} (\lambda)^* &amp;= \sum_{u = -\infty}^\infty \gamma_{\bullet, \bullet} (u)^* \times e^{i \lambda u} \\
  &amp;= \sum_{u = -\infty}^\infty \gamma_{\bullet, \bullet} (-u) \times e^{i \lambda u} \\
  &amp;= \sum_{\nu = -\infty}^\infty \gamma_{\bullet, \bullet} (\nu) \times e^{- i \lambda \nu} \\
  &amp;= f_{\bullet, \bullet} (\lambda)
\end{align}
\qquad(13.15)\]</span></span></p>
<p>We also have that matrix <span class="math inline">\(f_{\bullet, \bullet} (- \lambda)\)</span> is the transpose of <span class="math inline">\(f_{\bullet, \bullet} (\lambda)\)</span>.</p>
<p><span id="eq-spec-transpose"><span class="math display">\[
\begin{align}
  f_{\bullet, \bullet} (- \lambda) &amp;= \sum_{u = -\infty}^\infty \gamma_{\bullet, \bullet} (u) \times e^{i \lambda u} \\
  &amp;= \sum_{u = -\infty}^\infty \gamma_{\bullet, \bullet} (-u)^\prime \times e^{i \lambda u} \\
  &amp;= \sum_{\nu = -\infty}^\infty \gamma_{\bullet, \bullet} (\nu)^\prime \times e^{- i \lambda \nu} \\
  &amp;= f_{\bullet, \bullet} (\lambda)^\prime
\end{align}
\qquad(13.16)\]</span></span></p>
<p>That is</p>
<p><span id="eq-spec-elt-transpose"><span class="math display">\[
\begin{align}
  f_{a, b} (- \lambda) &amp;= f_{b, a} (\lambda)
\end{align}
\qquad(13.17)\]</span></span></p>
<p>Setting <span class="math inline">\(b = a\)</span> we see that the power spectrum is an even function.</p>
<p><span id="eq-poweer-spec-even"><span class="math display">\[
\begin{align}
  f_{a, a} (- \lambda) &amp;= f_{a, a} (\lambda)
\end{align}
\qquad(13.18)\]</span></span></p>
<p>Lastly, <a href="#eq-spec-dens" class="quarto-xref">Equation&nbsp;<span>13.11</span></a> has the following inverse.</p>
<p><span id="eq-ACovF-from-spec-dens"><span class="math display">\[
\begin{align}
  \gamma_{\bullet, \bullet} (u) &amp;= \frac{1}{2 \pi} \int_{- \pi}^\pi f_{\bullet, \bullet} (\lambda) \times e^{i \lambda u} \; d\lambda
\end{align}
\qquad(13.19)\]</span></span></p>
<p>Setting <span class="math inline">\(u = 0\)</span> we see that <span class="math inline">\(\gamma_{\bullet, \bullet} (0)\)</span>, the variance-covariance matrix of <span class="math inline">\(X_\bullet (t)\)</span>, is the average value of <span class="math inline">\(f_{\bullet, \bullet} (\cdot)\)</span>.</p>
<p><span id="eq-cov-from-spec-dens"><span class="math display">\[
\begin{align}
  \gamma_{\bullet, \bullet} (0) &amp;= \frac{1}{2 \pi} \int_{- \pi}^\pi f_{\bullet, \bullet} (\lambda) \; d\lambda
\end{align}
\qquad(13.20)\]</span></span></p>
</section>
<section id="cramér-representation" class="level3" data-number="13.2.6">
<h3 data-number="13.2.6" class="anchored" data-anchor-id="cramér-representation"><span class="header-section-number">13.2.6</span> Cramér representation</h3>
<p>It turns out<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a> that <a href="#eq-ACovF-sum" class="quarto-xref">Equation&nbsp;<span>13.12</span></a> implies the following Cramér representation of a centered version of <span class="math inline">\(X_\bullet (\cdot)\)</span>.</p>
<p><span id="eq-Cramér-rep"><span class="math display">\[
\begin{align}
  X_\bullet (t) - m_\bullet (t) &amp;= \int_{0}^{2 \pi} e^{i \lambda t} \; dZ_\bullet (\lambda)
\end{align}
\qquad(13.21)\]</span></span></p>
<p>where <span class="math inline">\(Z_\bullet (\cdot)\)</span> is a random complex-valued measure having mean value zero and having orthogonal increments<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a>:</p>
<p><span id="eq-ortho-incr"><span class="math display">\[
\begin{align}
  E \left \{ Z_\bullet ( \Delta_1 ) \; Z_\bullet ( \Delta_2 )^* \right \} &amp;= 0 \\ \\
  \text{whenever } \\ \\
  \Delta_1 \; \cap \; \Delta_2 &amp;= \emptyset
\end{align}
\qquad(13.22)\]</span></span></p>
<p>The magnitude of <span class="math inline">\(dZ_\bullet (\lambda)\)</span> (which has mean zero) can be measured by the following complex-valued version of the variance-covariance matrix.</p>
<p><span id="eq-var-Z"><span class="math display">\[
\begin{align}
  E \left \{ dZ_\bullet ( \lambda ) \; dZ_\bullet ( \lambda )^* \right \} &amp;= f_{\bullet, \bullet} (\lambda) \; d \lambda
\end{align}
\qquad(13.23)\]</span></span></p>
</section>
<section id="filtering" class="level3" data-number="13.2.7">
<h3 data-number="13.2.7" class="anchored" data-anchor-id="filtering"><span class="header-section-number">13.2.7</span> Filtering</h3>
<p>Suppose that <span class="math inline">\(X(t)\)</span> is a univariate random process satisfying <a href="#eq-ACovF-sum" class="quarto-xref">Equation&nbsp;<span>13.12</span></a> and having mean zero. Let <span class="math inline">\(a(\nu)\)</span> be a non-random summable sequence, and let <span class="math inline">\(Y(\cdot)\)</span> denote the convolution of <span class="math inline">\(a(\cdot)\)</span> with <span class="math inline">\(X(\cdot)\)</span>.</p>
<p><span id="eq-filter-demo"><span class="math display">\[
\begin{align}
  Y(\cdot) &amp;= a(\cdot) * X(\cdot) \\
  \\
  &amp;\text{so that } \\
  \\
  Y(t) &amp;= \sum_{\nu = - \infty}^\infty a(\nu) \times X(t - \nu)
\end{align}
\qquad(13.24)\]</span></span></p>
<p>Then <span class="math inline">\(Y(\cdot)\)</span> is said to be a <em>filtered</em> version of <span class="math inline">\(X(\cdot)\)</span>. One can show<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a> that <span class="math inline">\(Y(\cdot)\)</span> has the following Cramér representation.</p>
<p><span id="eq-filtered-Cramér"><span class="math display">\[
\begin{align}
  Y (t) &amp;= \int_{0}^{2 \pi} e^{i \lambda t} \; dZ_Y (\lambda) \\
  &amp;= \int_{0}^{2 \pi} e^{i \lambda t} \; A(\lambda) \; dZ_X (\lambda)
\end{align}
\qquad(13.25)\]</span></span></p>
<p>where <span class="math inline">\(A(\lambda)\)</span> is the Fourier transform of <span class="math inline">\(a(\nu)\)</span>.</p>
<p><span id="eq-transf-fn"><span class="math display">\[
\begin{align}
  A(\lambda) &amp;= \sum_{\nu = - \infty}^\infty a (\nu) \times e^{- i \lambda \nu}
\end{align}
\qquad(13.26)\]</span></span></p>
<p>The Fourier transform <span class="math inline">\(A (\lambda)\)</span> is called the <em>transfer function</em> of the filter, and the function <span class="math inline">\(a(\nu)\)</span> is called the <em>impulse response</em> function of the filter. (If one replaces <span class="math inline">\(X (\cdot)\)</span> with an “impulse” equal to unity at zero and equal to zero elsewhere one obtains <span class="math inline">\(Y(t) = a(t)\)</span>.)</p>
<p>From <a href="#eq-var-Z" class="quarto-xref">Equation&nbsp;<span>13.23</span></a> we see that</p>
<p><span id="eq-var-Z-Y"><span class="math display">\[
\begin{align}
  f_{Y, Y} (\lambda) \; d \lambda &amp;= E \left \{ dZ_Y ( \lambda ) \; dZ_Y ( \lambda )^* \right \}  \\
  &amp;= E \left \{ A(\lambda) \; dZ_X ( \lambda ) \; dZ_X ( \lambda )^* \; A(\lambda)^* \right \}  \\
  &amp;= \left | A(\lambda) \right |^2 \; E \left \{ dZ_X ( \lambda ) \; dZ_X ( \lambda )^* \right \}  \\
  &amp;= \left | A(\lambda) \right |^2 \; f_{X, X} (\lambda) \; d \lambda \\ \\
  \text{so that } \\ \\
  f_{Y, Y} (\lambda) &amp;= \left | A(\lambda) \right |^2 \; f_{X, X} (\lambda)
\end{align}
\qquad(13.27)\]</span></span></p>
</section>
<section id="white-noise" class="level3" data-number="13.2.8">
<h3 data-number="13.2.8" class="anchored" data-anchor-id="white-noise"><span class="header-section-number">13.2.8</span> White noise</h3>
<p>Let <span class="math inline">\(W(\cdot)\)</span> denote a univariate “white noise” process, that is, a process having zero mean and having the following auto-covariance function.</p>
<p><span id="eq-ACF-wn"><span class="math display">\[
\begin{align}
  \gamma_{W, W} (u) &amp;=
  \begin{cases}
    \sigma_W^2 &amp; \text{for } u = 0 \\
    0 &amp; \text{for } u \ne 0
  \end{cases}
\end{align}
\qquad(13.28)\]</span></span></p>
<p>We use the following notation to specify a white noise process.</p>
<p><span id="eq-wn-notation"><span class="math display">\[
\begin{align}
  W &amp;\sim wn(0, \sigma_W^2)
\end{align}
\qquad(13.29)\]</span></span></p>
<p>The power spectrum density function, <span class="math inline">\(f_{W, W} (\lambda)\)</span> is readily seen to evaluate to the constant <span class="math inline">\(\sigma_W^2\)</span>.</p>
<p><span id="eq-wn-spec-dens"><span class="math display">\[
\begin{align}
  f_{W, W} (\lambda) &amp;= \sum_{u = -\infty}^\infty \gamma_W (u) \times e^{- i \lambda u} \\
  &amp;= \gamma_W (0) \\
  &amp;= \sigma_W^2
\end{align}
\qquad(13.30)\]</span></span></p>
</section>
<section id="white-noise-filtered" class="level3" data-number="13.2.9">
<h3 data-number="13.2.9" class="anchored" data-anchor-id="white-noise-filtered"><span class="header-section-number">13.2.9</span> White noise filtered</h3>
<p>Now suppose that <span class="math inline">\(X(\cdot)\)</span> can be represented as the following filtered version of <span class="math inline">\(W(\cdot)\)</span>.</p>
<p><span id="eq-causal-form"><span class="math display">\[
\begin{align}
  X(t) &amp;= \sum_{\nu = 0}^\infty \psi_\nu \times W(t - \nu) \\ \\
  \text{where } \\ \\
  \sum_{\nu = 0}^\infty | \; \psi_\nu \; | &amp;&lt; \infty
\end{align}
\qquad(13.31)\]</span></span></p>
<p>From <a href="#eq-var-Z-Y" class="quarto-xref">Equation&nbsp;<span>13.27</span></a> we see that</p>
<p><span id="eq-spec-dens-causal"><span class="math display">\[
\begin{align}
  f_{X, X} (\lambda) &amp;= \left | \psi(e^{-i \lambda}) \right |^2 \; \sigma_W^2
\end{align}
\qquad(13.32)\]</span></span></p>
<p>where <span class="math inline">\(\psi(\cdot)\)</span> denotes the power series having coefficients <span class="math inline">\(\psi (\nu)\)</span>.</p>
<p><span id="eq-psi-power-series"><span class="math display">\[
\begin{align}
  \psi (z) &amp;= \sum_{\nu = 0}^\infty \psi_\nu \times z^\nu \quad \text{for } |z| \le 1
\end{align}
\qquad(13.33)\]</span></span></p>
</section>
<section id="arma-models" class="level3" data-number="13.2.10">
<h3 data-number="13.2.10" class="anchored" data-anchor-id="arma-models"><span class="header-section-number">13.2.10</span> ARMA models</h3>
<p>To elaborate, let’s define auto-regressive moving average (ARMA) models to develop such filtered versions of the white noise process <span class="math inline">\(W(\cdot)\)</span>. These models are defined by polynomials <span class="math inline">\(\phi(\cdot)\)</span> and <span class="math inline">\(\theta(\cdot)\)</span> applied to the back-shift operator <span class="math inline">\(\mathcal{B}\)</span> as follows. (We set the mean of each process to zero in order to simplify the notation.)</p>
<p><span id="eq-ARMA-p-q"><span class="math display">\[
\begin{align}
  \phi(\mathcal{B}) \; X(\cdot) &amp;= \theta(\mathcal{B}) \; W(\cdot) \\ \\
  \text{with } \\ \\
  \phi(z) &amp;= 1 - \sum_{j = 1}^p \phi_j \; z^j \\
  \theta(z) &amp;= 1 + \sum_{k = 1}^q \theta_k \; z^k \\ \\
  \text{so that } \\ \\
  X(t) &amp;= \sum_{j = 1}^p \phi_j \; X(t - j) \; + \; W(t) \; + \; \sum_{k = 1}^q \theta_k \; W(t - k)
\end{align}
\qquad(13.34)\]</span></span></p>
<p>Taking the multiplicative inverse of <span class="math inline">\(\phi(\cdot)\)</span> we can re-express this model as the following filtering of the white noise process <span class="math inline">\(W(\cdot)\)</span>.</p>
<p><span id="eq-ARMA-p-q-causal"><span class="math display">\[
\begin{align}
  X(\cdot) &amp;= \phi(\mathcal{B})^{-1} \;  \theta(\mathcal{B}) \; W(\cdot) \\ \\
  &amp;= \psi(\mathcal{B}) \; W(\cdot) \\ \\
  \text{where } \\ \\
  \psi (z) &amp;= \frac{\theta(z)}{\phi(z)} = \sum_{\nu = 0}^\infty \psi_\nu \times z^\nu
\end{align}
\qquad(13.35)\]</span></span></p>
<p>The power-series expansion of the rational function <span class="math inline">\(\psi(\cdot)\)</span> requires the roots of polynomial <span class="math inline">\(\phi(\cdot)\)</span> to all have magnitude greater than unity, which we assume to be the case. Now let us specify some simple examples.</p>
</section>
<section id="ar1" class="level3" data-number="13.2.11">
<h3 data-number="13.2.11" class="anchored" data-anchor-id="ar1"><span class="header-section-number">13.2.11</span> AR(1)</h3>
<p>First we define <span class="math inline">\(X(\cdot)\)</span> to be the following simple auto-regressive model, abbreviated <span class="math inline">\(AR(1)\)</span>.</p>
<p><span id="eq-AR-1"><span class="math display">\[
\begin{align}
  X(t) &amp;= \phi_1 \; X(t - 1) \; + \; W(t) \quad \text{with } | \phi_1 | &lt; 1
\end{align}
\qquad(13.36)\]</span></span></p>
<p>so that</p>
<p><span id="eq-AR-1-psi"><span class="math display">\[
\begin{align}
  \psi (z) &amp;= \frac{1}{1 - \phi_1 z} \\
  &amp;= \sum_{\nu = 0}^\infty \phi_1^\nu \times z^\nu
\end{align}
\qquad(13.37)\]</span></span></p>
<p>and</p>
<p><span id="eq-AR-1-spec"><span class="math display">\[
\begin{align}
  f_{X, X} (\lambda) &amp;= \left | \psi(e^{-i \lambda}) \right |^2 \; \sigma_W^2 \\
  &amp;= \left | \frac{1}{1 - \phi_1 e^{-i \lambda}} \right |^2 \; \sigma_W^2 \\
  &amp;= \frac{\sigma_W^2}{1 - 2 \phi_1 \cos(\lambda) + \phi_1^2}
\end{align}
\qquad(13.38)\]</span></span></p>
</section>
<section id="ma1" class="level3" data-number="13.2.12">
<h3 data-number="13.2.12" class="anchored" data-anchor-id="ma1"><span class="header-section-number">13.2.12</span> MA(1)</h3>
<p>Next, let <span class="math inline">\(Y(\cdot)\)</span> denote the following simple moving average model <span class="math inline">\((MA(1))\)</span>.</p>
<p><span id="eq-MA-1"><span class="math display">\[
\begin{align}
  Y(t) &amp;= W(t) \; + \; \theta_1 W(t - 1) \quad \text{with } | \theta_1 | &lt; 1
\end{align}
\qquad(13.39)\]</span></span></p>
<p>so that</p>
<p><span id="eq-MA-1-psi"><span class="math display">\[
\begin{align}
  \psi (z) &amp;= 1 + \theta_1 z
\end{align}
\qquad(13.40)\]</span></span></p>
<p>and</p>
<p><span id="eq-MA-1-spec"><span class="math display">\[
\begin{align}
  f_{Y, Y} (\lambda) &amp;= \left | \psi(e^{-i \lambda}) \right |^2 \; \sigma_W^2 \\
  &amp;= \left | 1 + \theta_1 e^{-i \lambda} \right |^2 \; \sigma_W^2 \\
  &amp;= \left ( 1 + 2 \theta_1 \cos(\lambda) + \theta_1^2 \right ) \; \sigma_W^2 \\
\end{align}
\qquad(13.41)\]</span></span></p>
</section>
<section id="arma1-1" class="level3" data-number="13.2.13">
<h3 data-number="13.2.13" class="anchored" data-anchor-id="arma1-1"><span class="header-section-number">13.2.13</span> ARMA(1, 1)</h3>
<p>Finally we let <span class="math inline">\(Z(\cdot)\)</span> denote the following <span class="math inline">\((ARMA(1, 1))\)</span> model.</p>
<p><span id="eq-ARMA-1-1"><span class="math display">\[
\begin{align}
  Z(t) &amp;= \phi_1 Z(t - 1) \; + \; W(t) \; + \; \theta_1 W(t - 1)
\end{align}
\qquad(13.42)\]</span></span></p>
<p>so that</p>
<p><span id="eq-ARMA-1-1-psi"><span class="math display">\[
\begin{align}
  \psi (z) &amp;= \frac{1 + \theta_1 z}{1 - \phi_1 z} \\
  &amp;= (1 + \theta_1 z) \; \sum_{\nu = 0}^\infty \phi_1^\nu \times z^\nu \\
  &amp;= 1 \; + \; \sum_{k = 1}^\infty (\phi_1^k + \theta_1 \; \phi_1^{k - 1}) \times z^k
\end{align}
\qquad(13.43)\]</span></span></p>
<p>and</p>
<p><span id="eq-ARMA-1-1-spec"><span class="math display">\[
\begin{align}
  f_{Z, Z} (\lambda) &amp;= \left | \psi(e^{-i \lambda}) \right |^2 \; \sigma_W^2 \\
  &amp;= \left | \frac{1 + \theta_1 e^{-i \lambda}}{1 - \phi_1 e^{-i \lambda}} \right |^2 \; \sigma_W^2 \\
  &amp;= \frac{1 + 2 \theta_1 \cos(\lambda) + \theta_1^2}{1 - 2 \phi_1 \cos(\lambda) + \phi_1^2} \; \sigma_W^2
\end{align}
\qquad(13.44)\]</span></span></p>
</section>
<section id="comparison-of-arma-models" class="level3" data-number="13.2.14">
<h3 data-number="13.2.14" class="anchored" data-anchor-id="comparison-of-arma-models"><span class="header-section-number">13.2.14</span> Comparison of ARMA models</h3>
<p><a href="#fig-ARMA-sim-ts" class="quarto-xref">Figure&nbsp;<span>13.1</span></a> shows the respective time series simulated from these simple ARMA models, with the following parameter settings: <span class="math inline">\(\phi_1 =\)</span> 0.9; <span class="math inline">\(\theta_1 =\)</span> 0.9; <span class="math inline">\(\sigma_W =\)</span> 1.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ARMA-sim-ts" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ARMA-sim-ts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ts-fourier_files/figure-html/fig-ARMA-sim-ts-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ARMA-sim-ts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.1: Simulation from simple ARMA models
</figcaption>
</figure>
</div>
</div>
</div>
<p>The trajectory of the white noise process <span class="math inline">\(W(\cdot)\)</span> is indeed noisy; it would remain qualitatively unchanged by any permutation of its values. The MA(1) model generating <span class="math inline">\(Y(\cdot)\)</span> also displays a rather noisy trajectory. The remaining models, the AR(1) model generating <span class="math inline">\(X(\cdot)\)</span> and the ARMA(1, 1) model generating <span class="math inline">\(Z(\cdot)\)</span> show greater continuity.</p>
<p><a href="#fig-ARMA-spec" class="quarto-xref">Figure&nbsp;<span>13.2</span></a> shows the respective spectrum density functions of these ARMA models. The spectrum densities of the AR(1) model and the ARMA(1, 1) model are concentrated at lower frequencies, correponding to greater wavelengths. Note that the horizontal axis labeled “freq” is a scaled version of <span class="math inline">\(\lambda\)</span>, namely <span class="math inline">\(\mathcal{f} = \frac{\lambda}{2 \pi}\)</span>, which is the inverse of wavelength.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-ARMA-spec" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ARMA-spec-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ts-fourier_files/figure-html/fig-ARMA-spec-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ARMA-spec-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.2: Spectrum density function of each ARMA model
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="sec-finite-FT" class="level2" data-number="13.3">
<h2 data-number="13.3" class="anchored" data-anchor-id="sec-finite-FT"><span class="header-section-number">13.3</span> Finite Fourier transform</h2>
<section id="definition" class="level3" data-number="13.3.1">
<h3 data-number="13.3.1" class="anchored" data-anchor-id="definition"><span class="header-section-number">13.3.1</span> Definition</h3>
<p>Let <span class="math inline">\(X_\bullet (\cdot)\)</span> be a random process satisfying <a href="#eq-ACovF-sum" class="quarto-xref">Equation&nbsp;<span>13.12</span></a>. Assume for the moment that <span class="math inline">\(X_\bullet (\cdot)\)</span> has mean zero. Suppose that we have data generated by this process for <span class="math inline">\(|t| \le n\)</span>.<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a> Then we define <span class="math inline">\(d_\bullet (\lambda)\)</span>, the finite Fourier transform of time series <span class="math inline">\(\{ X(t) \}_{|t| \le n}\)</span>, as follows.</p>
<p><span id="eq-finite-FT"><span class="math display">\[
\begin{align}
  d_\bullet (\lambda) &amp;= \sum_{t = -n}^n X_\bullet (t) \times e^{- i \lambda t}
\end{align}
\qquad(13.45)\]</span></span></p>
</section>
<section id="cramér-representation-1" class="level3" data-number="13.3.2">
<h3 data-number="13.3.2" class="anchored" data-anchor-id="cramér-representation-1"><span class="header-section-number">13.3.2</span> Cramér representation</h3>
<p>From the Cramér representation (<a href="#eq-Cramér-rep" class="quarto-xref">Equation&nbsp;<span>13.21</span></a>) we have</p>
<p><span id="eq-DFT-Cramér-rep"><span class="math display">\[
\begin{align}
  d_\bullet (\lambda) &amp;= \sum_{t = -n}^n X_\bullet (t) \times e^{- i \lambda t} \\
  &amp;= \sum_{t = -n}^n \left \{ \int_{0}^{2 \pi} e^{i \alpha t} \; dZ_\bullet (\alpha) \right \} \times e^{- i \lambda t} \\
  &amp;= \sum_{t = -n}^n \left \{ \int_{0}^{2 \pi} e^{i (\alpha - \lambda) t} \; dZ_\bullet (\alpha) \right \} \\
  &amp;= \int_{0}^{2 \pi} \left \{ \sum_{t = -n}^n e^{i (\alpha - \lambda) t}  \right \} \; dZ_\bullet (\alpha) \\
  &amp;= \int_{0}^{2 \pi} \mathcal{D}_n (\alpha - \lambda) \; dZ_\bullet (\alpha)
\end{align}
\qquad(13.46)\]</span></span></p>
<p>Here <span class="math inline">\(\mathcal{D}_n (\cdot)\)</span> denotes the Dirichlet kernel function of order <span class="math inline">\(n\)</span>.</p>
<p><span id="eq-Dirichlet-kernel-fn"><span class="math display">\[
\begin{align}
   \mathcal{D}_n (\theta) &amp;= \sum_{\nu = -n}^n e^{i \theta \nu} \\
   &amp;=
   \begin{cases}
     2 n + 1 &amp; \text{for } \theta \equiv 0 \bmod (2 \pi) \\
     \frac{\sin ((2n + 1) \theta / 2)}{\sin(\theta / 2)} &amp; \text{for } \theta \not \equiv 0 \bmod (2 \pi)
   \end{cases}
\end{align}
\qquad(13.47)\]</span></span></p>
</section>
<section id="data-windows-and-their-frequency-kernels" class="level3" data-number="13.3.3">
<h3 data-number="13.3.3" class="anchored" data-anchor-id="data-windows-and-their-frequency-kernels"><span class="header-section-number">13.3.3</span> Data windows and their frequency kernels</h3>
<p><span class="math inline">\(\mathcal{D}_n (\cdot)\)</span> is thus the Fourier transform of the indicator function <span class="math inline">\(1_{|t| \le n} (\cdot)\)</span>. In the early 1900’s Fejér noted that the approximation of a function by a finite Fourier series could be improved by replacing this indicator function by its Cesàro average (the average of partial sums). This has led to the applicaton of <em>data windows</em> of the form <span class="math inline">\(h(t/n)\)</span> and their Fourier transforms <span class="math inline">\(\mathcal{H}_n(\theta)\)</span> as follows.</p>
<p><span id="eq-tapered-FT-Cramér-rep"><span class="math display">\[
\begin{align}
  d_\bullet (\lambda) &amp;= \sum_{t = -n}^n h(\frac{t}{n}) \times X_\bullet (t) \times e^{- i \lambda t} \\
  &amp;= \int_{0}^{2 \pi} \mathcal{H}_n (\alpha - \lambda) \; dZ_\bullet (\alpha) \\ \\
  &amp;\text{where } \\ \\
  \mathcal{H}_n (\theta) &amp;= \sum_{\nu = -n}^n h(\frac{\nu}{n}) \times e^{i \theta \nu}
\end{align}
\qquad(13.48)\]</span></span></p>
<p>Function <span class="math inline">\(h(x)\)</span> (called a <em>convergence factor</em> or <em>data taper</em>) is typically chosen to be positive, even, and piecewise continuous, having a maximum of unity at <span class="math inline">\(x = 0\)</span>, and vanishing for <span class="math inline">\(|x| &gt; 1\)</span>. This ensures that the <span class="math inline">\(2 \pi\)</span>-periodic function <span class="math inline">\(\mathcal{H}_n (\theta)\)</span> (called a <em>frequency kernel</em>) integrates to unity over any interval of length <span class="math inline">\(2 \pi\)</span> and is increasingly concentrated near <span class="math inline">\(\theta \equiv 0 \bmod (2 \pi)\)</span> as <span class="math inline">\(n \rightarrow \infty\)</span>.<a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a></p>
<p>In time series applications, the data taper <span class="math inline">\(h(x)\)</span> is designed to produce a corresponding frequency kernel <span class="math inline">\(\mathcal{H}_n (\theta)\)</span> highly concentrated at frequency zero, to the degree allowed by other considerations, such as computational complexity.</p>
</section>
<section id="asymptotic-normality" class="level3" data-number="13.3.4">
<h3 data-number="13.3.4" class="anchored" data-anchor-id="asymptotic-normality"><span class="header-section-number">13.3.4</span> Asymptotic normality</h3>
<p>If <span class="math inline">\(X_\bullet\)</span> satisfies further regularity conditions<a href="#fn14" class="footnote-ref" id="fnref14" role="doc-noteref"><sup>14</sup></a> then <span class="math inline">\(d_\bullet (\lambda)\)</span> defined in <a href="#eq-tapered-FT-Cramér-rep" class="quarto-xref">Equation&nbsp;<span>13.48</span></a> has an asymptotic multivariate normal distribution. This asymptotic distribution is a standard (real-valued) multivariate normal distribution if <span class="math inline">\(\lambda \equiv 0 \bmod \pi\)</span>. Otherwise, it is a complex multivariate normal distribution (which doubles the degrees of freedom).<a href="#fn15" class="footnote-ref" id="fnref15" role="doc-noteref"><sup>15</sup></a></p>
<p>For <span class="math inline">\(\lambda \not \equiv 0 \bmod (2 \pi)\)</span>, the expected value of <span class="math inline">\(d_\bullet (\lambda)\)</span> is zero. At <span class="math inline">\(\lambda \equiv 0 \bmod (2 \pi)\)</span>, the expected value of <span class="math inline">\(d_\bullet (\lambda)\)</span> is proportionate to the mean of <span class="math inline">\(X_\bullet (\cdot)\)</span> (assumed in this section to be zero to simplify notation). The asymptotic variance of <span class="math inline">\(d_\bullet (\lambda)\)</span> is as follows.</p>
<p><span id="eq-var-tapered-FT"><span class="math display">\[
\begin{align}
  Var \{ d_\bullet (\lambda) \} &amp;\sim (2n + 1) \; \pi \; \eta^2 f_{\bullet, \bullet} (\lambda) \\ \\
  &amp; \text{where } \\ \\
  \eta^2 &amp;= \int_{-1}^1 h(x)^2 \; dx
\end{align}
\qquad(13.49)\]</span></span></p>
<p>Moreover if <span class="math inline">\(0 \le \lambda_0 &lt; \lambda_1 &lt; \ldots &lt; \lambda_K \le \pi\)</span>, then <span class="math inline">\(\{ d_\bullet (\lambda_k) \}_k\)</span> are asymptotically independent.<a href="#fn16" class="footnote-ref" id="fnref16" role="doc-noteref"><sup>16</sup></a></p>
</section>
</section>
<section id="sec-spec-est" class="level2" data-number="13.4">
<h2 data-number="13.4" class="anchored" data-anchor-id="sec-spec-est"><span class="header-section-number">13.4</span> Spectrum Estimation</h2>
<p>In this section we continue to assume that <span class="math inline">\(X_\bullet (\cdot)\)</span> has mean zero in order to simplify notation and focus on key ideas.</p>
<section id="periodogram" class="level3" data-number="13.4.1">
<h3 data-number="13.4.1" class="anchored" data-anchor-id="periodogram"><span class="header-section-number">13.4.1</span> Periodogram</h3>
<p>The term “periodogram” was introduced by Schuster<a href="#fn17" class="footnote-ref" id="fnref17" role="doc-noteref"><sup>17</sup></a> in 1898, who sought to detect hidden periodicities in natural phenomena. It is defined as a scaled version of <span class="math inline">\(d_\bullet (\lambda) \times d_\bullet (\lambda)^*\)</span>.</p>
<p>Recall that for <span class="math inline">\(\lambda \not \equiv 0 \bmod (2 \pi)\)</span>, the expected value of <span class="math inline">\(d_\bullet (\lambda)\)</span> is zero. Moreover, we assume that <span class="math inline">\(X_\bullet (\cdot)\)</span>, and thus <span class="math inline">\(d_\bullet (0)\)</span>, has mean zero in order to simplify notation. Consequently, the asymptotic expected value of <span class="math inline">\(d_\bullet (\lambda) \times d_\bullet (\lambda)^*\)</span> is the asymptotic variance-covariance matrix given by <a href="#eq-var-tapered-FT" class="quarto-xref">Equation&nbsp;<span>13.49</span></a>.</p>
<p><span id="eq-e-d-d"><span class="math display">\[
\begin{align}
  E \{ d_\bullet (\lambda) \times d_\bullet (\lambda)^* \} &amp;\sim (2n + 1) \; \pi \; \eta^2 f_{\bullet, \bullet} (\lambda) \\ \\
  &amp; \text{where } \\ \\
  \eta^2 &amp;= \int_{-1}^1 h(x)^2 \; dx
\end{align}
\qquad(13.50)\]</span></span></p>
<p>Following conventional use of the symbol <span class="math inline">\(I\)</span> to denote “intensity”, we define the <em>periodogram</em> as the following complex-valued, non-negative definite matrix</p>
<p><span id="eq-pgram"><span class="math display">\[
\begin{align}
  I_{\bullet, \bullet} (\lambda) &amp;= c_n \; d_\bullet (\lambda) \times d_\bullet (\lambda)^* \\ \\
  &amp; \text{where } \\ \\
  c_n &amp;= \left \{ (2n + 1) \; \pi \; \eta^2 \right \}^{-1}
\end{align}
\qquad(13.51)\]</span></span></p>
<p>so that</p>
<p><span id="eq-e-pgram"><span class="math display">\[
\begin{align}
  E \{ I_{\bullet, \bullet} (\lambda) \} &amp;\sim f_{\bullet, \bullet} (\lambda)
\end{align}
\qquad(13.52)\]</span></span></p>
<p>Thus the periodogram <span class="math inline">\(I_{\bullet, \bullet} (\lambda)\)</span> is an asymptotically unbiased estimate of the spectrum density <span class="math inline">\(f_{\bullet, \bullet} (\lambda)\)</span>. The problem is that the variance of <span class="math inline">\(I_{\bullet, \bullet} (\lambda)\)</span> elements remains large as <span class="math inline">\(n \rightarrow \infty\)</span>.</p>
<p>Recall that under regularity conditions on <span class="math inline">\(X(\cdot)\)</span>, <span class="math inline">\(d_\bullet(\lambda)\)</span> follows an asymptotically normal distribution. Under those same conditions the asymptotic distribution of <span class="math inline">\(I_{\bullet, \bullet} (\lambda)\)</span> is a Wishart distribution, real if <span class="math inline">\(\lambda \equiv 0 \bmod \pi\)</span> and complex otherwise.</p>
<p>A diagonal element of <span class="math inline">\(I_{\bullet, \bullet} (\lambda)\)</span>, say <span class="math inline">\(I_{a, a} (\lambda)\)</span>, is an estimate of <span class="math inline">\(f_{a, a} (\lambda)\)</span>, the power spectrum of <span class="math inline">\(X_a (\cdot)\)</span>. For <span class="math inline">\(\lambda \equiv 0 \bmod \pi\)</span>, the estimate is asymptotically distributed as <span class="math inline">\(f_{a, a} (\lambda) \times \chi_1^2\)</span>, where <span class="math inline">\(\chi_\nu^2\)</span> denotes a random variable having a chi-squared distribution with <span class="math inline">\(\nu\)</span> degrees of freedom. For <span class="math inline">\(\lambda \not \equiv 0 \bmod \pi\)</span>, the estimate is asymptotically distributed as <span class="math inline">\(f_{a, a} (\lambda) \times \chi_2^2 / 2\)</span>.<a href="#fn18" class="footnote-ref" id="fnref18" role="doc-noteref"><sup>18</sup></a></p>
<p><span id="eq-distn-pgram"><span class="math display">\[
\begin{align}
  I_{a, a} (\lambda) &amp;\sim
  \begin{cases}
    f_{a, a} (\lambda) \times \chi_1^2 &amp; \text{if } \lambda \equiv 0 \bmod \pi \\
    f_{a, a} (\lambda) \times \chi_2^2 / 2 &amp; \text{if } \lambda \not \equiv 0 \bmod \pi
  \end{cases}
\end{align}
\qquad(13.53)\]</span></span></p>
<p><span id="eq-var-pgram"><span class="math display">\[
\begin{align}
  Var \{ I_{a, a} (\lambda) \} &amp;\sim
  \begin{cases}
    2 f_{a, a} (\lambda)^2 &amp; \text{if } \lambda \equiv 0 \bmod \pi \\
    f_{a, a} (\lambda)^2 &amp; \text{if } \lambda \not \equiv 0 \bmod \pi
  \end{cases}
\end{align}
\qquad(13.54)\]</span></span></p>
<p>Thus <span class="math inline">\(I_{\bullet, \bullet} (\lambda)\)</span>, although asymptotically unbiased, is not a consistent estimator of <span class="math inline">\(f_{\bullet, \bullet} (\lambda)\)</span> since the variance of its diagonal elements remains bounded above zero as <span class="math inline">\(n \rightarrow \infty\)</span>.</p>
</section>
<section id="dft-discrete-fourier-transform" class="level3" data-number="13.4.2">
<h3 data-number="13.4.2" class="anchored" data-anchor-id="dft-discrete-fourier-transform"><span class="header-section-number">13.4.2</span> DFT: Discrete Fourier transform</h3>
<p>The discrete Fourier transform (DFT) is the restriction of the finite Fourier transform to a discrete set of equi-spaced frequencies. To simplify notation we consider a univariate process <span class="math inline">\(X(\cdot)\)</span>. We also index observed values as <span class="math inline">\(\{ X(0), X(1), \ldots, X(T-1) \}\)</span>. Now we define the DFT of this time series as follows.</p>
<p><span id="eq-DFT-T"><span class="math display">\[
\begin{align}
  d_X (\lambda_j) &amp;= \sum_{t = 0}^{T - 1} h \left (\frac{2(t - t_m)}{T} \right ) \times X(t) \times e^{- i \lambda_j t} \\ \\
  &amp; \text{where } \\ \\
  t_m &amp;= \frac{T - 1}{2}
\end{align}
\qquad(13.55)\]</span></span></p>
<p>The fast Fourier transform (FFT<a href="#fn19" class="footnote-ref" id="fnref19" role="doc-noteref"><sup>19</sup></a>) enables efficient computation of the DFT at a set of <span class="math inline">\(S\)</span> frequencies, where <span class="math inline">\(S \ge T\)</span> is chosen to be a highly composite number.</p>
<p><span id="eq-FFT-freqs"><span class="math display">\[
\begin{align}
  \lambda_j &amp;= \frac{2 \pi j}{S} \quad \text{for } j \in \{0, \ldots, S - 1 \}
\end{align}
\qquad(13.56)\]</span></span></p>
<p>The computational steps are:</p>
<ul>
<li>apply taper <span class="math inline">\(h(\cdot)\)</span> to <span class="math inline">\(\{ X(t) \}_{t = 0}^{T-1}\)</span></li>
<li>“pad” the tapered data by appending <span class="math inline">\(S - T\)</span> zeros</li>
<li>submit the padded, tapered data to the FFT algorithm</li>
</ul>
<p>In <code>R</code> the DFT can be computed with the function <code>stats:fft()</code>.</p>
</section>
<section id="smoothed-periodogram" class="level3" data-number="13.4.3">
<h3 data-number="13.4.3" class="anchored" data-anchor-id="smoothed-periodogram"><span class="header-section-number">13.4.3</span> Smoothed periodogram</h3>
<p>We noted above that the periodogram <span class="math inline">\(I_{\bullet, \bullet} (\lambda)\)</span>, although an asymptotically unbiased estimate of <span class="math inline">\(f_{\bullet, \bullet} (\lambda)\)</span>, suffers from high variance (which is evident from plots of the periodogram). Averaging periodogram values at adjacent frequencies yields a revised estimate, say <span class="math inline">\(\hat{f}_{\bullet, \bullet} (\lambda)\)</span>, having lower variance, but if too many periodogram values are averaged <span class="math inline">\(\hat{f}_{\bullet, \bullet} (\lambda)\)</span> may be a biased estimate that blurs features of interest.</p>
<p>Here is a framework for constructing a consistent<a href="#fn20" class="footnote-ref" id="fnref20" role="doc-noteref"><sup>20</sup></a> estimator, that is, a sequence of estimates that converge to <span class="math inline">\(f_{\bullet, \bullet} (\lambda)\)</span> as <span class="math inline">\(T \rightarrow \infty\)</span>. Let <span class="math inline">\(\beta_T &gt; 0\)</span> denote the bandwidth of adjacent frequencies to be averaged. To drive the variance of successive estimates to zero as <span class="math inline">\(T \rightarrow \infty\)</span> we want the number of adjacent frequencies, proportionate to <span class="math inline">\(\beta_T \; T\)</span>, to increase without bound. To drive the bias to zero we want the neighborhood of averaged frequencies to shrink to <span class="math inline">\(\lambda\)</span>, thus requiring <span class="math inline">\(\beta_T \rightarrow 0\)</span>. For example we might set <span class="math inline">\(\beta_T = 1/\sqrt{T}\)</span>, or more generally <span class="math inline">\(\beta_T = c \; T^{- \alpha}\)</span> for some choice of <span class="math inline">\(c &gt; 0\)</span> and <span class="math inline">\(\alpha \in (0, 1)\)</span>.</p>
<p>This framework also requires a frequency window function <span class="math inline">\(W(\cdot)\)</span> that integrates to unity and is even, absolutely integrable, and of bounded variation.</p>
<p><span id="eq-freq-window"><span class="math display">\[
\begin{align}
  &amp; W(-\alpha) = W(\alpha) \\
  &amp; \int_{-\infty}^\infty | W(\alpha) | \; d \alpha &lt; \infty \\
  &amp; \int_{-\infty}^\infty W(\alpha) \; d \alpha = 1
\end{align}
\qquad(13.57)\]</span></span></p>
<p>Now we define <span class="math inline">\(\hat{f}_{\bullet, \bullet} (\lambda)\)</span> as follows.<a href="#fn21" class="footnote-ref" id="fnref21" role="doc-noteref"><sup>21</sup></a></p>
<p><span id="eq-consistent-spec-dens-est"><span class="math display">\[
\begin{align}
  \hat{f}_{\bullet, \bullet} (\lambda) &amp;= \sum_{\lambda_j \not \equiv 0 \bmod (2 \pi)} \frac{1}{\beta_T} \; W \left ( \frac{\lambda - \lambda_j}{\beta_T} \right ) \times I_{\bullet, \bullet} ( \lambda_j ) \\ \\
  &amp; \text{where } \\ \\
  \lambda_j &amp;= \frac{2 \pi j}{S} \quad \forall j \in \mathbb{Z}
\end{align}
\qquad(13.58)\]</span></span></p>
<p>Under the previously mentioned regularity conditions for <span class="math inline">\(X_{\bullet, \bullet} (\cdot)\)</span>, <span class="math inline">\(\hat{f}_{\bullet, \bullet} (\lambda)\)</span> is a consistent estimator and is asymptotically normal.</p>
<p>The asymptotic variance of <span class="math inline">\(\hat{f}_{a, a} (\lambda)\)</span>, the estimated power spectrum of <span class="math inline">\(X_a (\cdot)\)</span>, is as follows.</p>
<p><span id="eq-v-consistent-pwr-spec-est"><span class="math display">\[
\begin{align}
  Var\{ \hat{f}_{a, a} (\lambda) \} &amp;\sim
  \begin{cases}
    4 \pi \omega^2 \; \frac{f_{a, a} (\lambda)^2}{\beta_T \; T} &amp; \text{for } \lambda \equiv 0 \bmod \pi \\
    2 \pi \omega^2 \; \frac{f_{a, a} (\lambda)^2}{\beta_T \; T} &amp; \text{for } \lambda \not \equiv 0 \bmod \pi
  \end{cases} \\ \\
  &amp; \text{where } \\ \\
  \omega^2 &amp;= \int_{- \infty}^\infty W(\alpha)^2 d \alpha
\end{align}
\qquad(13.59)\]</span></span></p>
<p>Taking the natural logarithm, and assuming <span class="math inline">\(f_{a, a} (\lambda) &gt; 0\)</span>, we have that <span class="math inline">\(\ln \hat{f}_{a, a} (\lambda)\)</span> is a consistent and asymptotically normal estimate of <span class="math inline">\(\ln f_{a, a} (\lambda)\)</span> with the following asymptotic variance.<a href="#fn22" class="footnote-ref" id="fnref22" role="doc-noteref"><sup>22</sup></a></p>
<p><span id="eq-v-ln-pwr-spec-est"><span class="math display">\[
\begin{align}
  Var\{ \ln \hat{f}_{a, a} (\lambda) \} &amp;\sim
  \begin{cases}
    \frac{4 \pi \omega^2}{\beta_T \; T} &amp; \text{for } \lambda \equiv 0 \bmod \pi \\
    \frac{2 \pi \omega^2}{\beta_T \; T} &amp; \text{for } \lambda \not \equiv 0 \bmod \pi
  \end{cases}
\end{align}
\qquad(13.60)\]</span></span></p>
</section>
</section>
<section id="sec-spec-examples" class="level2" data-number="13.5">
<h2 data-number="13.5" class="anchored" data-anchor-id="sec-spec-examples"><span class="header-section-number">13.5</span> Examples of Spectrum Analysis</h2>
<p>In <a href="#sec-intro" class="quarto-xref"><span>Section 13.1</span></a> we introduced a few sets of time series data and considered questions that we now attempt to address.</p>
<p>The <code>R</code> function <code>stats::spec.pgram()</code> is used to estimate spectra in this section. A raised cosine bell-shaped function is used to taper a user-specified portion of the head and tail of data. The tapered data are padded with zeros for efficient use of the FFT algorithm. The periodogram is calculated and then a modified Daniell frequency kernel averages across adjacent frequencies within a user-specified bandwidth. The function documentation gives further details.</p>
<section id="sunspots-1" class="level3" data-number="13.5.1">
<h3 data-number="13.5.1" class="anchored" data-anchor-id="sunspots-1"><span class="header-section-number">13.5.1</span> Sunspots</h3>
<p><a href="#fig-sunspot-spec" class="quarto-xref">Figure&nbsp;<span>13.3</span></a> below shows the estimated spectrum density function of monthly sunspot numbers. The first and final quarter of the data were tapered to better resolve the spectrum at adjacent frequencies. For the same reason the density estimate is a running weighed average of only 17 adjacent periodogram values, amounting to a fairly narrow bandwidth (0.012).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-sunspot-spec" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sunspot-spec-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ts-fourier_files/figure-html/fig-sunspot-spec-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sunspot-spec-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.3: Monthly sunspot numbers: estimated spectrum density
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-sunspot-spec_log10" class="quarto-xref">Figure&nbsp;<span>13.4</span></a> gives a closer view of the spectrum density function at the lowest observable frequencies. The peak in the spectrum occurs at frequency 0.008 cycles per month corresponding to a wavelength of 10.8 years. As previously mentioned, the gaps between peak values of sunspot numbers vary somewhat, which is part of the reason for the breadth of this peak in the spectrum density (the other part being the unavoidable periodogram-averaging required to lower the variance of the estimated spectrum density function.)</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-sunspot-spec_log10" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sunspot-spec_log10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ts-fourier_files/figure-html/fig-sunspot-spec_log10-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sunspot-spec_log10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.4: Sunspot spectrum density: zoomed-in view
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="city-temperatures" class="level3" data-number="13.5.2">
<h3 data-number="13.5.2" class="anchored" data-anchor-id="city-temperatures"><span class="header-section-number">13.5.2</span> City Temperatures</h3>
<p><a href="#fig-hnl-nyc-spec" class="quarto-xref">Figure&nbsp;<span>13.5</span></a> below shows (on a log-10 scale) estimated spectrum densities of daily temperatures in Honolulu and New York City.<a href="#fn23" class="footnote-ref" id="fnref23" role="doc-noteref"><sup>23</sup></a></p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-hnl-nyc-spec" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hnl-nyc-spec-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ts-fourier_files/figure-html/fig-hnl-nyc-spec-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hnl-nyc-spec-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.5: City temperatures: estimated spectrum densities
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-hnl-nyc-spec-zoom" class="quarto-xref">Figure&nbsp;<span>13.6</span></a> gives a zoomed-in view of the lowest observable frequencies. For both cities the peak in the spectrum occurs at frequency 0.003 cycles per day corresponding to a wavelength of 360.6 days, a bit below the expected 365.25 days due to imperfect frequency resolution.</p>
<p>Previously we noted that Honolulu temperatures fluctuate much less than New York City temperatures, and we raised the question of the degree to which the annual cycle contributes to overall variability in each city. The respective ratios of max-divided-by-min (or log-max minus log-min) of the spectrum density estimates appear similar in the two cities, with New York exhibiting a somewhat greater range. This suggests that annual variability in Honolulu contributes nearly as much to the overall variance of temperatures as it does in New York City.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-hnl-nyc-spec-zoom" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hnl-nyc-spec-zoom-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ts-fourier_files/figure-html/fig-hnl-nyc-spec-zoom-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hnl-nyc-spec-zoom-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.6: City temperature spectra: zoomed-in view
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-hnl-nyc-cp-zoom" class="quarto-xref">Figure&nbsp;<span>13.7</span></a> shows the two cities to be nearly perfectly coherent and in phase at frequenccies near the annual cycle, as expected.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-hnl-nyc-cp-zoom" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hnl-nyc-cp-zoom-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ts-fourier_files/figure-html/fig-hnl-nyc-cp-zoom-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hnl-nyc-cp-zoom-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.7: HNL-NYC coherence and phase: zoomed-in view
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="closing-remarks" class="level2" data-number="13.6">
<h2 data-number="13.6" class="anchored" data-anchor-id="closing-remarks"><span class="header-section-number">13.6</span> Closing Remarks</h2>
<p>This note is intended to illustrate some uses of spectrum analysis, and to introduce the corresponding mathematical framework and methods of estimation.</p>
</section>
<section id="sec-glossary" class="level2" data-number="13.7">
<h2 data-number="13.7" class="anchored" data-anchor-id="sec-glossary"><span class="header-section-number">13.7</span> A: Glossary of Notation</h2>
<p><span class="math display">\[
\begin{align}
  {a_{\bullet, \bullet} (u)}
    \quad &amp; \quad \text{matrix of filter coefficients at time-shift } u \\
  \\
  \mathcal{B}
     \quad &amp; \quad \text{back-shift operator } \\
  \\
  \beta_T
     \quad &amp; \quad \text{frequency bandwidth of averaged periodogram values } \\
  \\
  DFT
     \quad &amp; \quad \text{discrete Fourier transform } \\
  \\
  d_\bullet (\lambda)
     \quad &amp; \quad \text{finite Fourier transform of } X_\bullet (t) \\
  \\
  FFT
     \quad &amp; \quad \text{fast Fourier transform algorithm } \\
  \\
  f_{\bullet, \bullet} (\lambda)
     \quad &amp; \quad \text{spectrum density matrix at frequency } \lambda \\
  \\
  \hat{f}_{\bullet, \bullet} (\lambda)
     \quad &amp; \quad \text{estimate of } f_{\bullet, \bullet} (\lambda) \\
  \\
  \phi(\cdot)
     \quad &amp; \quad \text{AR polynomial, } 1 - \sum_{\nu = 1}^p \phi_\nu \; z^\nu \\
  \\
  \gamma_{\bullet, \bullet} (u)
     \quad &amp; \quad \text{auto-covariance matrix at time-shift } u \\
  \\
  h (x)
     \quad &amp; \quad \text{data-taper or convergence factor } \\
  \\
  \mathcal{H}_n (\lambda)
     \quad &amp; \quad \text{finite Fourier transform of } h(\frac{t}{n}) \\
  \\
  I_{\bullet, \bullet} (\lambda)
     \quad &amp; \quad \text{periodogram at frequency } \lambda \\
  \\
  \mathcal{I}
     \quad &amp; \quad \text{identity operator } \\
  \\
  m_\bullet (t)
     \quad &amp; \quad E \{ X_\bullet (t) \} \text{, expected value of } X_\bullet (t) \\
  \\
  \mu_X
     \quad &amp; \quad E\{ X (t_0) \} \text{, expected value of } X (t_0) \\
  \\   
  \hat{\mu}_X
     \quad &amp; \quad \text{sample mean, } S_{X, T} / T \\
  \\   
  \nu_T
     \quad &amp; \quad \{ 0, 1, \dots, T-1 \} \\
  \\
  R_{a, b} (\lambda)
     \quad &amp; \quad \text{coherency: } \frac{f_{a, b}(\lambda)}{\sqrt{f_{a, a}(\lambda) f_{b, b}(\lambda)}} \\
  \\
  | R_{a, b} (\lambda) |^2
     \quad &amp; \quad \text{coherence } \\
  \\
  Arg(\; R_{a, b} (\lambda) \;)
     \quad &amp; \quad \text{phase } \\
  \\
  \rho_{\bullet, \bullet} (u)
     \quad &amp; \quad \text{autocorrelation matrix at time-shift } u \\
  \\
  S_{X, T}
     \quad &amp; \quad \text{the sample sum of T observations of } X (\cdot) \\
  \\
  \sigma_X^2
     \quad &amp; \quad Var \{ X (t_0) \} \text{, variance of } X (t_0) \\
  \\
  T
     \quad &amp; \quad \text{number of time series observations } \\
  \\
  t_0
     \quad &amp; \quad \text{initial time index of time series observations } \\
  \\
  t_f
     \quad &amp; \quad \text{final time index of time series observations } \\
  \\
  \tau_T
     \quad &amp; \quad t_0 + \{ 0, 1, \ldots, T-1  \} \\
  \\
  \theta(\cdot)
     \quad &amp; \quad \text{MA polynomial, } 1 + \sum_{\nu = 1}^q \theta_\nu \; z^\nu \\
  \\
  W(\cdot)
     \quad &amp; \quad \text{white noise process, } W(\cdot) \sim wn(0, \sigma_W^2)  \\
  \\
  W(\lambda)
     \quad &amp; \quad \text{frequency window or kernel function}  \\
  \\
  X_\bullet (t)
     \quad &amp; \quad (X_1 (t), \ldots, X_d (t)) \text{, a multivariate random process }  \\
  \\
  dZ_\bullet (\lambda)
     \quad &amp; \quad \text{Cramér representation of } X_\bullet (t)
\end{align}
\]</span></p>
</section>
<section id="sec-data-examples" class="level2" data-number="13.8">
<h2 data-number="13.8" class="anchored" data-anchor-id="sec-data-examples"><span class="header-section-number">13.8</span> B: Data Examples</h2>
<section id="sunspot-numbers-monthly-averages-1749---present" class="level3" data-number="13.8.1">
<h3 data-number="13.8.1" class="anchored" data-anchor-id="sunspot-numbers-monthly-averages-1749---present"><span class="header-section-number">13.8.1</span> Sunspot Numbers: Monthly Averages, 1749 - Present</h3>
<section id="description" class="level4" data-number="13.8.1.1">
<h4 data-number="13.8.1.1" class="anchored" data-anchor-id="description"><span class="header-section-number">13.8.1.1</span> Description</h4>
<p><a href="#fig-sunspots" class="quarto-xref">Figure&nbsp;<span>13.8</span></a> below shows <code>sunspot.month</code>, monthly average sunspot numbers, in <code>R</code> package <code>datasets</code>. Source: Solar Influences Data Analysis Center (SIDC), Royal Observatory of Belgium. The data shown here span the years 1749-2025, for a total of 3310 months (275 years and 10 months).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-sunspots" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-sunspots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ts-fourier_files/figure-html/fig-sunspots-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sunspots-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.8: Sunspot numbers: monthly average
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="context-questions-and-objectives" class="level4" data-number="13.8.1.2">
<h4 data-number="13.8.1.2" class="anchored" data-anchor-id="context-questions-and-objectives"><span class="header-section-number">13.8.1.2</span> Context: Questions and Objectives</h4>
<p>As described in <a href="https://link.springer.com/article/10.1007/s11207-023-02136-3">Recalibration of the Sunspot-Number: Status Report | Solar Physics</a>, the record of sunspot numbers links past and present solar behavior, and is the primary input for reconstructions of total solar irradiance (TSI) for years before 1978.</p>
</section>
</section>
<section id="daily-city-temperatures-1995-2020" class="level3" data-number="13.8.2">
<h3 data-number="13.8.2" class="anchored" data-anchor-id="daily-city-temperatures-1995-2020"><span class="header-section-number">13.8.2</span> Daily City Temperatures: 1995-2020</h3>
<section id="description-1" class="level4" data-number="13.8.2.1">
<h4 data-number="13.8.2.1" class="anchored" data-anchor-id="description-1"><span class="header-section-number">13.8.2.1</span> Description</h4>
<p><a href="#fig-hnl-nyc-temps" class="quarto-xref">Figure&nbsp;<span>13.9</span></a> below shows the daily average temperature in Honolulu and New York City from 1995-01-01 to 2020-05-13 (for a total or 9265 days).<a href="#fn24" class="footnote-ref" id="fnref24" role="doc-noteref"><sup>24</sup></a></p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-hnl-nyc-temps" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hnl-nyc-temps-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="ts-fourier_files/figure-html/fig-hnl-nyc-temps-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hnl-nyc-temps-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.9: Daily Average Temperature (F), HNL and NYC, 1995-2020
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="context-questions-and-objectives-1" class="level4" data-number="13.8.2.2">
<h4 data-number="13.8.2.2" class="anchored" data-anchor-id="context-questions-and-objectives-1"><span class="header-section-number">13.8.2.2</span> Context: Questions and Objectives</h4>
<p>The temperatures shown are available from <a href="https://www.kaggle.com/datasets/sudalairajkumar/daily-temperature-of-major-cities">Kaggle</a> (obtained from the University of Dayton) as part of a collection of temperatures at 157 cities in the US and 167 cities across the globe. These surface temperatures are one of several variables that are used to model weather systems worldwide.</p>
<p>Also see the following R packages:</p>
<ul>
<li><a href="https://cran.r-project.org/web/packages/GSODR/readme/README.html">GSOD</a>, Global Surface Summary of the Day</li>
<li><a href="https://cran.r-project.org/web/packages/climate/vignettes/getstarted.html">climate</a></li>
</ul>
</section>
</section>
</section>
<section id="references" class="level2" data-number="13.9">
<h2 data-number="13.9" class="anchored" data-anchor-id="references"><span class="header-section-number">13.9</span> References</h2>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>See <a href="https://chandra.harvard.edu/edu/formal/icecore/The_Historical_Sunspot_Record.pdf">The Historical Sunspot Record</a>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Occasionally “time series” methods are applied to data indexed not by time but rather by length, or some other linear dimension. For example see <span class="citation" data-cites="thomson1977">(<a href="references.html#ref-thomson1977" role="doc-biblioref"><strong>thomson1977?</strong></a>)</span>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>We assume the components of <span class="math inline">\(X_\bullet(t)\)</span> to be real-valued, unless stated otherwise.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>For a univariate time series <span class="math inline">\(X(t)\)</span> we denote distributional parameters either omitting a subscript or else using the subscript <span class="math inline">\(X\)</span>.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>The assumption of second-order (or wide-sense) stationarity suffices for most time series models used in practice, but some cases may call for the assumption of <em>strict stationarity</em>. This means that for any finite set of times <span class="math inline">\((t_1, \ldots, t_K)\)</span> and any time-shift <span class="math inline">\(s\)</span>, the joint probability distribution of <span class="math inline">\((X_\bullet (t_1), \ldots, X_\bullet (t_K))\)</span> is identical to that of <span class="math inline">\((X_\bullet (t_1 - s), \ldots, X_\bullet (t_K - s))\)</span>.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>See <span class="citation" data-cites="Newton1672spectrum">(<a href="references.html#ref-Newton1672spectrum" role="doc-biblioref"><strong>Newton1672spectrum?</strong></a>)</span>.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>Also see <span class="citation" data-cites="brillinger1993digitalrainbow">(<a href="references.html#ref-brillinger1993digitalrainbow" role="doc-biblioref"><strong>brillinger1993digitalrainbow?</strong></a>)</span>.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>In other contexts the term “intensity” is replaced by “power”. <span class="citation" data-cites="wiener1930GHA">(<a href="references.html#ref-wiener1930GHA" role="doc-biblioref"><strong>wiener1930GHA?</strong></a>)</span> introduced the term “power spectrum” of a signal.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>See <span class="citation" data-cites="brillinger2001">(<a href="references.html#ref-brillinger2001" role="doc-biblioref"><strong>brillinger2001?</strong></a>)</span>.<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>Given a complex-valued matrix or vector <span class="math inline">\(\zeta\)</span> we denote by <span class="math inline">\(\zeta^*\)</span> its conjugate transpose.<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p>See <span class="citation" data-cites="brillinger2001">(<a href="references.html#ref-brillinger2001" role="doc-biblioref"><strong>brillinger2001?</strong></a>)</span><a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12"><p>To simplify notation in this section we change the range of integer index <span class="math inline">\(t\)</span> from <span class="math inline">\(t \in [0, T)\)</span> to <span class="math inline">\(t \in [-n, n]\)</span>.<a href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn13"><p>See <span class="citation" data-cites="brillinger2001">(<a href="references.html#ref-brillinger2001" role="doc-biblioref"><strong>brillinger2001?</strong></a>)</span>.<a href="#fnref13" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn14"><p>See <span class="citation" data-cites="brillinger2001">(<a href="references.html#ref-brillinger2001" role="doc-biblioref"><strong>brillinger2001?</strong></a>)</span>. Asymptotic normality of the discrete Fourier transform is ensured if <span class="math inline">\(X_\bullet (\cdot)\)</span> is strictly stationary and has summable cumulants of all orders.<a href="#fnref14" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn15"><p>See <span class="citation" data-cites="brillinger2001">(<a href="references.html#ref-brillinger2001" role="doc-biblioref"><strong>brillinger2001?</strong></a>)</span>. If <span class="math inline">\(U_\bullet\)</span> and <span class="math inline">\(V_\bullet\)</span> are random, real-valued vectors, each having <span class="math inline">\(d\)</span> elements, then <span class="math inline">\(W = U + i V\)</span> is said to have a complex normal distribution provided that the <span class="math inline">\(2d\)</span>-vector <span class="math inline">\((U, V)\)</span> has a multivariate normal distribution whose variance-covariance matrix is such that <span class="math inline">\(\Sigma_{V, V} = \Sigma_{U, U}\)</span> and <span class="math inline">\(\Sigma_{V, U}\)</span> is skew-symmetric, so that <span class="math inline">\(\Sigma_{V, U} = -\Sigma_{U, V}\)</span>.<a href="#fnref15" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn16"><p>See <span class="citation" data-cites="brillinger2001">(<a href="references.html#ref-brillinger2001" role="doc-biblioref"><strong>brillinger2001?</strong></a>, Theorem 4.4.2)</span>.<a href="#fnref16" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn17"><p>See <span class="citation" data-cites="schuster1898">(<a href="references.html#ref-schuster1898" role="doc-biblioref"><strong>schuster1898?</strong></a>)</span>.<a href="#fnref17" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn18"><p>See <span class="citation" data-cites="brillinger2001">(<a href="references.html#ref-brillinger2001" role="doc-biblioref"><strong>brillinger2001?</strong></a>, Theorem 5.2.7)</span>.<a href="#fnref18" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn19"><p>See <span class="citation" data-cites="FFT_Wikipedia_2025">(<a href="references.html#ref-FFT_Wikipedia_2025" role="doc-biblioref"><strong>FFT_Wikipedia_2025?</strong></a>)</span>.<a href="#fnref19" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn20"><p>That is, mean-square consistent: the expected squared estimation error tends to zero as <span class="math inline">\(T \rightarrow \infty\)</span>.<a href="#fnref20" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn21"><p>Although this summation extends over an infinite number of discrete frequencies <span class="math inline">\(\lambda_j\)</span>, there are just <span class="math inline">\(S\)</span> frequencies modulo <span class="math inline">\(2 \pi\)</span>. Recall that the periodogram is <span class="math inline">\(2 \pi\)</span>-periodic. In addition, we may define the frequency window <span class="math inline">\(W(\cdot)\)</span> equal to zero outside some finite interval.<a href="#fnref21" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn22"><p>See <span class="citation" data-cites="brillinger2001">(<a href="references.html#ref-brillinger2001" role="doc-biblioref"><strong>brillinger2001?</strong></a>)</span> for further details.<a href="#fnref22" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn23"><p>We have used the same parameter settings for tapering and periodogram-averaging as in the sunspot example.<a href="#fnref23" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn24"><p>For convenience missing values have been imputed (estimated) with a weighted running average spanning 7 days. This was done with <code>R</code> function <code>imputeTS::na.ma()</code>. Of the 9265 days shown, there were 18 missing values for Honolulu and 20 missing values for NYC.<a href="#fnref24" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/github\.com\/tthrall\/eda4ml\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ts-forecast.html" class="pagination-link" aria-label="Time Series Forecasting">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Time Series Forecasting</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./graph-theory.html" class="pagination-link" aria-label="Graph Theory for Machine Learning">
        <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Graph Theory for Machine Learning</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/tthrall/eda4ml/edit/main/ts-fourier.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/tthrall/eda4ml/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>